# PolyLinga 全機能一覧

## 1. メイン学習ページ

| ページ | パス | 機能 |
|--------|------|------|
| ダッシュボード | `/app/dashboard` | ユーザー挨拶、言語選択、レベル/XP進捗、ストリーク表示、優先タスク、ギフトボタン |
| フレーズ | `/app/phrases` | フレーズセット管理、カテゴリ別閲覧、フレーズ追加モーダル、チュートリアル |
| AI添削 | `/app/corrections` | AIによる文章添削、発音評価、差分ハイライト、丁寧度選択 |
| アウェアネス | `/app/awareness` | メモ管理、SRS（間隔反復学習）、復習スケジュール、統計表示 |
| マイフレーズ | `/app/my-phrases` | コレクション管理、リスト/カード表示切替 |
| 履歴 | `/app/history` | 時系列フレーズ表示、音声再生、長押しコントロール |
| ショップ | `/app/shop` | サブスクリプション、単体購入、コイン通貨 |
| 設定 | `/app/settings` | プロフィール、言語、表示、通知設定 |
| 基本フレーズ | `/app/basic-phrases` | プリセットフレーズ、カテゴリ別閲覧 |
| スラング | `/app/slang` | スラング用語データベース |
| 通知 | `/app/notifications` | お知らせ一覧、タイプ別フィルター |
| アカウント | `/app/account` | プラン表示、使用量確認、クレジット残高 |

---

## 2. AI機能

| 機能 | 説明 |
|------|------|
| **トークン化** | GPT-4による多言語テキスト分割（日/韓/中/英/越対応） |
| **AI添削** | 文法・スタイル修正、スコアリング、差分表示 |
| **発音評価** | 音声認識(Whisper)、発音スコア(0-100)、差分ハイライト |
| **テキスト読み上げ(TTS)** | Gemini 2.5 Pro TTS、多言語対応、速度調整、声選択 |
| **画像からフレーズ抽出** | OCR+GPT Vision、非同期ジョブ処理、リアルタイムポーリング |
| **スラング抽出** | テキストからスラング用語を抽出・定義 |
| **フレーズ説明** | 単語・フレーズの意味・用法説明 |

---

## 3. 学習システム

| 機能 | 詳細 |
|------|------|
| **TokenizedSentence** | トークン単位選択、ピンイン表示、ドラッグ&ドロップ |
| **間隔反復学習(SRS)** | 6段階強度(0-5)、復習間隔: 10分→1日→3日→7日→14日→30日 |
| **メモシステム** | 未確認→試行済み→確認済みのステータス進行 |
| **信頼度レベル** | 高/中/低の3段階、色分け表示 |
| **復習スケジューリング** | 忘却曲線に基づく最適タイミング計算 |
| **使用回数追跡** | 各メモの使用頻度記録 |

---

## 4. ゲーミフィケーション

| 機能 | 詳細 |
|------|------|
| **レベルシステム** | XP蓄積、レベルアップ、称号付与 |
| **ストリーク** | 連続ログイン日数、最長記録、リセット防止 |
| **デイリークエスト** | 日替わりタスク、進捗追跡、達成報酬 |
| **バッジシステム** | 実績達成、アイコン付きバッジ |
| **コイン通貨** | 活動報酬、ショップ購入、配布イベント |
| **学習イベントログ** | 全アクティビティ記録、XP付与 |

---

## 5. コンテンツ管理

| 機能 | 詳細 |
|------|------|
| **フレーズセット** | カスタム作成、アイコン/色設定、並び替え |
| **フレーズコレクション** | 個人ライブラリ、カテゴリ整理 |
| **アウェアネスメモ** | トークン単位のメモ、信頼度設定 |
| **フレーズエクスプローラー** | サイドパネル検索、文脈調査 |
| **基本フレーズDB** | 9言語対応プリセット |
| **スラングDB** | タイプ分類、例文付き |

---

## 6. 音声機能

| 機能 | 詳細 |
|------|------|
| **音声再生** | TTS自動生成、キャッシュ(24時間TTL) |
| **速度調整** | 0.75x / 1x / 1.25x 切替 |
| **声選択** | 言語別複数ボイス、性別フィルター |
| **学習者モード** | ゆっくり・明瞭な発音 |
| **音声録音** | 発音練習用マイク入力 |
| **長押しコントロール** | クイック設定アクセス |

---

## 7. 設定・カスタマイズ

| カテゴリ | 設定項目 |
|----------|----------|
| **プロフィール** | ユーザー名、性別、母国語、学習言語 |
| **表示** | 信頼度色表示切替、ピンインON/OFF、デフォルトビュー |
| **音声** | ボイス選択、速度、学習者モード |
| **通知** | リマインダーON/OFF、時刻設定 |

---

## 8. 課金・ショップ

| プラン | 価格 | 内容 |
|--------|------|------|
| **Free** | 無料 | 音声5回/日、添削3回/日、抽出1回/月 |
| **Standard** | ¥480/月 | 音声30回/日、添削10回/日、抽出10回/月 |
| **Pro** | ¥980/月 | 音声100回/日、添削30回/日、抽出30回/月 |

**単体購入:**
- 音声再生: ¥2/50回
- エクスプローラー: ¥2/50回
- 添削: ¥3/10回
- 画像抽出: ¥10/1回
- 説明: ¥5/30回

---

## 9. 認証・アカウント

| 機能 | 詳細 |
|------|------|
| **メール登録** | パスワード認証、メール確認 |
| **マジックリンク** | パスワードレスログイン |
| **OAuth** | ソーシャルログイン対応 |
| **セッション管理** | 自動ログイン維持 |
| **プロフィール作成** | 初回登録時自動生成 |

---

## 10. 管理者機能

| ページ | 機能 |
|--------|------|
| `/admin/announcements` | お知らせ作成・編集・削除・スケジュール |
| `/admin/dashboard-data` | ダッシュボードデータ管理 |
| `/admin/slang` | スラングDB管理 |
| `/admin/support` | サポートチケット管理 |
| **配布イベント** | ギフト作成、定期配布(日/週/月)、報酬設定 |

---

## 11. 通知システム

| 機能 | 詳細 |
|------|------|
| **お知らせベル** | 未読カウント表示 |
| **抽出ジョブ通知** | リアルタイムポーリング、完了Toast |
| **ギフト通知** | 配布報酬の受取可能表示 |
| **Toastシステム** | 一時的なフィードバック表示 |

---

## 12. PWA・オフライン

| 機能 | 詳細 |
|------|------|
| **PWAインストール** | ホーム画面追加対応 |
| **Service Worker** | Workboxによるキャッシュ |
| **オフライン対応** | 基本機能のオフライン動作 |
| **スプラッシュ画面** | アプリ起動時表示 |

---

## 13. UI/UX機能

| 機能 | 詳細 |
|------|------|
| **レスポンシブ** | モバイル/デスクトップ最適化 |
| **ボトムナビ** | モバイル用固定ナビ |
| **サイドバー** | デスクトップ用ナビ |
| **チュートリアル** | ページ別インタラクティブガイド |
| **Framer Motion** | スムーズなアニメーション |
| **長押しジェスチャー** | クイックアクション |

---

## 14. 多言語対応

**学習言語:** 英語、ベトナム語、中国語、韓国語、日本語、インドネシア語、タイ語、スペイン語

**ネイティブ言語:** 日本語、韓国語、英語、ベトナム語、中国語

**言語パック:** 日/韓/英/中/仏/西/独/露/越 (9言語)

---

## 15. API エンドポイント (15個)

| エンドポイント | 用途 |
|----------------|------|
| `GET /api/dashboard` | 進捗・クエスト・バッジ・使用量取得 |
| `POST /api/checkin` | デイリーストリーク記録 |
| `POST /api/correction` | AI添削処理 |
| `POST /api/pronunciation/evaluate` | 発音評価 |
| `GET /api/speech-token` | TTSトークン取得 |
| `POST /api/events` | 学習イベント記録 |
| `GET /api/announcements` | お知らせ取得 |
| `POST /api/distributions/claim` | 報酬受取 |
| `GET /api/distributions/available` | 利用可能配布一覧 |
| `GET /api/extraction-jobs/pending` | 抽出ジョブポーリング |
| `POST /api/cron/process-extractions` | バックグラウンドジョブ処理 |

---

## 16. データベーステーブル (19個)

`profiles`, `awareness_memos`, `learning_events`, `phrase_collections`, `phrase_sets`, `phrase_set_items`, `pronunciation_runs`, `daily_usage`, `daily_quest_templates`, `badges`, `levels`, `distribution_events`, `distribution_claims`, `extraction_jobs`, `announcements`, `user_login_days`, `user_streaks`, `user_progress`, `user_badges`

---

## 17. 状態管理ストア (9個)

`useAppStore`, `useAwarenessStore`, `useHistoryStore`, `useCollectionsStore`, `usePhraseSetStore`, `useSettingsStore`, `useExtractionJobsStore`, `useSlangStore`, `useExplorerStore`

---

## 統計サマリー

| 指標 | 値 |
|------|-----|
| 総ファイル数 | 304 |
| ページルート | 34 |
| APIルート | 15 |
| DBテーブル | 19 |
| 状態ストア | 9 |
| 対応言語 | 9 |
| ソースコードサイズ | 約3.5 MB |

---

## 計画中: ショップ体験機能

### 概要
購入画面で追加コンテンツを実際に体験できるようにする。使い方も体験して覚えてもらう。

### 音声プレミアム体験
- 実際のPhraseCardをショップに埋め込み（demoMode）
- 長押しで30種類の音声選択を体験
- 長押しで再生速度選択（0.5x〜2.0x）を体験
- 事前生成した音声を使用 → APIコスト0

### サンプル音声
- 1つの英文で全音声を事前生成
- 30音声 × 通常/ゆっくり = 60ファイル
- 再生速度はブラウザのplaybackRateで調整（追加ファイル不要）
- 保存先: `public/samples/voices/{voice}/{normal|slow}.mp3`

### 設定の分離（重要）
体験モードの設定変更はユーザーの実際の学習設定に影響しない：
| 設定 | 体験モード | 通常モード |
|------|-----------|-----------|
| 音声選択 | ローカルstate | settingsStore |
| はっきり読む | ローカルstate | settingsStore |
| 再生速度 | ローカルstate | settingsStore |
| 音声ソース | 事前生成ファイルのみ | API or 事前生成 |

### 実装タスク
- [x] サンプル音声60ファイル生成
- [x] PhraseCardにdemoModeプロップ追加
- [x] demoMode時はローカルstateで設定管理（音声・はっきり読む・再生速度）
- [x] ShopProductModalに体験UI追加
- [x] ヒントテキスト「長押しで音声・速度を選べます」
